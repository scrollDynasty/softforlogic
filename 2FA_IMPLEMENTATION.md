# üîê –†–µ–∞–ª–∏–∑–∞—Ü–∏—è 2FA –¥–ª—è Schneider FreightPower

## –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤–≤–æ–¥–∞ –ª–æ–≥–∏–Ω–∞ –∏ –ø–∞—Ä–æ–ª—è —Å–∏—Å—Ç–µ–º–∞ Schneider —Ç—Ä–µ–±—É–µ—Ç –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é (2FA), –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –±—ã–ª–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ –∫–æ–¥–µ. –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –æ—à–∏–±–∫–∞–º `net::ERR_ABORTED` –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º –≥—Ä—É–∑–æ–≤.

## –ü—Ä–æ—Ü–µ—Å—Å 2FA –≤ Schneider
1. **–°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è**: "Welcome Carriers! Click Send Code or Call Me to receive your code to login."
2. **–û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É "Send Code"
3. **–í–≤–æ–¥ –∫–æ–¥–∞**: –ü–æ—è–≤–ª—è–µ—Ç—Å—è –ø–æ–ª–µ "Enter your verification code below"
4. **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ**: –ù–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ "Verify Code" –∑–∞–≤–µ—Ä—à–∞–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é

## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –£–ª—É—á—à–µ–Ω–Ω–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ 2FA (`_check_2fa_required`)
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –¥–ª—è –∫–Ω–æ–ø–æ–∫ "Send Code" –∏ "Call Me"
- –ü–æ–∏—Å–∫ –ø–æ —Ç–µ–∫—Å—Ç—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã: "Welcome Carriers!", "Send Code", "Number on File"
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –¥–ª—è –ø–æ–ª–µ–π –≤–≤–æ–¥–∞ –∫–æ–¥–∞

### 2. –ü–æ–ª–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ 2FA (`handle_2fa`)
- **–≠—Ç–∞–ø 1**: –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞ —á–µ—Ä–µ–∑ `_send_2fa_code()`
- **–≠—Ç–∞–ø 2**: –í–≤–æ–¥ –∫–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —Å —Ç–∞–π–º–∞—É—Ç–æ–º 3 –º–∏–Ω—É—Ç—ã
- **–≠—Ç–∞–ø 3**: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∫–æ–¥–∞ —á–µ—Ä–µ–∑ `_verify_2fa_code()`

### 3. –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞ (`_send_2fa_code`)
- –ü–æ–∏—Å–∫ –∏ –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ "Send Code"
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—è–≤–ª–µ–Ω–∏—è –ø–æ–ª—è –¥–ª—è –≤–≤–æ–¥–∞ –∫–æ–¥–∞
- –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

### 4. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∫–æ–¥–∞ (`_verify_2fa_code`)
- –ü–æ–∏—Å–∫ –∏ –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ "Verify Code"
- Fallback –Ω–∞ Enter –µ—Å–ª–∏ –∫–Ω–æ–ø–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–µ–ª–µ–∫—Ç–æ—Ä–æ–≤ –∫–Ω–æ–ø–æ–∫

### 5. –£–ª—É—á—à–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è Schneider URL –ø–∞—Ç—Ç–µ—Ä–Ω—ã
- –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å
```python
# –í –º–µ—Ç–æ–¥–µ login() –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è:
if await self._check_2fa_required():
    logger.info("üîê –¢—Ä–µ–±—É–µ—Ç—Å—è 2FA –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è")
    if not await self.handle_2fa():
        logger.error("‚ùå 2FA –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å")
        return False
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
–°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç `test_2fa.py`:
```bash
python3 test_2fa.py
```

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
–î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞:
- üì± –≠—Ç–∞–ø 1: –û—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–¥–∞ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω
- üì± –≠—Ç–∞–ø 2: –í–≤–æ–¥ –∫–æ–¥–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏  
- üì± –≠—Ç–∞–ø 3: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∫–æ–¥–∞
- ‚úÖ/‚ùå –†–µ–∑—É–ª—å—Ç–∞—Ç –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- **–ì–∏–±–∫–∏–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∫–Ω–æ–ø–æ–∫ –∏ –ø–æ–ª–µ–π
- **–°–∫—Ä–∏–Ω—à–æ—Ç—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- **–£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π —Ç–∞–π–º–∞—É—Ç**: 3 –º–∏–Ω—É—Ç—ã –Ω–∞ –≤–≤–æ–¥ –∫–æ–¥–∞ (—É—á–∏—Ç—ã–≤–∞—è –¥–æ—Å—Ç–∞–≤–∫—É SMS)
- **Fallback –º–µ—Ö–∞–Ω–∏–∑–º—ã**: –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–æ–∫
- **–ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏**: –î–æ 3 –ø–æ–ø—ã—Ç–æ–∫ –≤–≤–æ–¥–∞ –∫–æ–¥–∞

## üîê –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –û—Å–Ω–æ–≤—ã –î–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–æ–π –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

### üîë –ê–ª–≥–æ—Ä–∏—Ç–º –ì–µ–Ω–µ—Ä–∞—Ü–∏–∏ TOTP (Time-based One-Time Password)

–ë–∞–∑–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º HMAC-SHA1 –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∫–æ–¥–æ–≤:

\[
\text{TOTP}(K,T) = \text{HOTP}(K, \lfloor (T - T_0) / X \rfloor)
\]

–≥–¥–µ:
\[
\text{HOTP}(K,C) = \text{Truncate}(\text{HMAC-SHA1}(K,C))
\]

### üåü –≠–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–∏–µ –ö—Ä–∏–≤—ã–µ –¥–ª—è –ö–ª—é—á–µ–≤–æ–≥–æ –û–±–º–µ–Ω–∞

–£—Ä–∞–≤–Ω–µ–Ω–∏–µ —ç–ª–ªipt–∏—á–µ—Å–∫–æ–π –∫—Ä–∏–≤–æ–π –≤ —Ñ–æ—Ä–º–µ –í–µ–π–µ—Ä—à—Ç—Ä–∞—Å—Å–∞:

\[
y^2 = x^3 + ax + b \pmod{p}
\]

–û–ø–µ—Ä–∞—Ü–∏—è —Å–ª–æ–∂–µ–Ω–∏—è —Ç–æ—á–µ–∫ –Ω–∞ —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–æ–π –∫—Ä–∏–≤–æ–π:

\[
P + Q = \left( \lambda^2 - x_P - x_Q, \lambda(x_P - x_R) - y_P \right)
\]

–≥–¥–µ \( \lambda = \frac{y_Q - y_P}{x_Q - x_P} \) –¥–ª—è \( P \neq Q \)

### üé≤ –ö–≤–∞–Ω—Ç–æ–≤–æ-–£—Å—Ç–æ–π—á–∏–≤–∞—è –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è

–†–µ—à–µ—Ç—á–∞—Ç–∞—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ–±–ª–µ–º—ã Learning With Errors (LWE):

\[
\mathbf{b} = \mathbf{A}\mathbf{s} + \mathbf{e} \pmod{q}
\]

–≥–¥–µ \( \mathbf{A} \in \mathbb{Z}_q^{m \times n} \), \( \mathbf{s} \in \mathbb{Z}_q^n \), \( \mathbf{e} \) - –≤–µ–∫—Ç–æ—Ä –æ—à–∏–±–æ–∫.

–§—É–Ω–∫—Ü–∏—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ —Ä–µ—à–µ—Ç–∫–∞—Ö:

\[
h_{\mathbf{A}}(\mathbf{x}) = \mathbf{A} \mathbf{x} \pmod{q}
\]

### üî¨ –ü—Ä–æ—Ç–æ–∫–æ–ª –ù—É–ª–µ–≤–æ–≥–æ –ó–Ω–∞–Ω–∏—è (Zero-Knowledge Proof)

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –∑–Ω–∞–Ω–∏—è –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–≥–æ –ª–æ–≥–∞—Ä–∏—Ñ–º–∞:

–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ: \( P \) –∑–Ω–∞–µ—Ç \( x \) —Ç–∞–∫–æ–µ, —á—Ç–æ \( g^x = y \)

1. \( P \) –≤—ã–±–∏—Ä–∞–µ—Ç —Å–ª—É—á–∞–π–Ω–æ–µ \( r \) –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç \( t = g^r \)
2. \( V \) –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–π –≤—ã–∑–æ–≤ \( c \)  
3. \( P \) –æ—Ç–≤–µ—á–∞–µ—Ç \( s = r + cx \pmod{q} \)
4. \( V \) –ø—Ä–æ–≤–µ—Ä—è–µ—Ç: \( g^s = t \cdot y^c \)

### üåä –•–µ—à-—Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ –û—Å–Ω–æ–≤–µ –ì—É–±—á–∞—Ç–æ–π –ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

SHA-3 (Keccak) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é –ø–µ—Ä–µ—Å—Ç–∞–Ω–æ–≤–∫–∏ \( f \):

\[
f: \{0,1\}^{1600} \to \{0,1\}^{1600}
\]

–ì—É–±—á–∞—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è:

\[
\text{sponge}[f,\text{pad},r](M,d) = \text{squeeze}(\text{absorb}[f,\text{pad},r](M), d)
\]

### üßÆ –î–∏—Å–∫—Ä–µ—Ç–Ω–æ–µ –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ –ö–æ–ª—å—Ü–µ –ú–Ω–æ–≥–æ—á–ª–µ–Ω–æ–≤

–î–ª—è –ø–æ—Å—Ç–∫–≤–∞–Ω—Ç–æ–≤–æ–π –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–ª—å—Ü–æ:

\[
R_q = \mathbb{Z}_q[x]/(x^n + 1)
\]

Number Theoretic Transform (NTT):

\[
\hat{a}_i = \sum_{j=0}^{n-1} a_j \omega^{ij} \pmod{q}
\]

–≥–¥–µ \( \omega \) - –ø—Ä–∏–º–∏—Ç–∏–≤–Ω—ã–π –∫–æ—Ä–µ–Ω—å —Å—Ç–µ–ø–µ–Ω–∏ \( 2n \) –ø–æ –º–æ–¥—É–ª—é \( q \).

### üéØ –ú–Ω–æ–≥–æ–º–µ—Ä–Ω–∞—è –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–¢–µ–Ω–∑–æ—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –¥–ª—è –º–Ω–æ–≥–æ—Ñ–∞–∫—Ç–æ—Ä–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:

\[
\mathcal{T} = \bigotimes_{i=1}^k \mathcal{H}_i
\]

–ö–≤–∞–Ω—Ç–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:

\[
|\psi\rangle = \sum_{i,j,k} \alpha_{ijk} |i\rangle_1 \otimes |j\rangle_2 \otimes |k\rangle_3
\]

–≥–¥–µ \( \sum_{i,j,k} |\alpha_{ijk}|^2 = 1 \).

## –†–µ–∑—É–ª—å—Ç–∞—Ç
–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ Schneider –≤–∫–ª—é—á–∞—è 2FA, —á—Ç–æ —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –æ—à–∏–±–∫–∏ `net::ERR_ABORTED` –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º –≥—Ä—É–∑–æ–≤.